[project]
name = "obfuscator"
msvc-runtime = "static"

[options]
BUILD_TESTS = true
ENABLE_LOGGING = true

[fetch-content.zasm]
git = "https://github.com/zyantific/zasm"
tag = "a18fa34251b161cc18e4c0fc385dee7cea104cfd"

[fetch-content.GTest]
git = "https://github.com/google/googletest"
tag = "v1.15.2"
condition = "build-tests"

[target.riscvm]
type = "interface"
include-directories = ["../riscvm"]

[target.linux_pe]
type = "interface"
include-directories = ["thirdparty/linux-pe"]
compile-features = ["cxx_std_20"]

[target.obfuscator_lib]
type = "static"
sources = ["lib/src/**.cpp"]
headers = ["lib/include/**.hpp"]
include-directories = ["lib/include"]
compile-features = ["cxx_std_20"]
link-libraries = ["zasm::zasm", "linux_pe"]
ENABLE_LOGGING.compile-definitions = ["ENABLE_LOGGING"]

[target.obfuscator]
type = "executable"
sources = ["src/main.cpp"]
compile-features = ["cxx_std_20"]
link-libraries = ["obfuscator_lib"]

[target.obfuscator_tests]
type = "executable"
condition = "build-tests"
sources = ["tests/**.cpp"]
headers = ["tests/**.hpp"]
link-libraries = ["obfuscator_lib", "GTest::gtest_main", "riscvm"]
